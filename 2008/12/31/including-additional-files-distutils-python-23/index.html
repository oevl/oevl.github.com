<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Installing additional files with distutils in Python 2.3 â€” Arthur Koziel</title>
    <link rel="stylesheet" href="/master2.css" type="text/css" media="screen" />
    <link rel="alternate" type="application/rss+xml" title="Atom Feed" href="/feeds/main.xml" />
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-4143429-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script');
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 
            'http://www') + '.google-analytics.com/ga.js';
        ga.setAttribute('async', 'true');
        document.documentElement.firstChild.appendChild(ga);
      })();
    </script>
</head>
<body>
    <p>
        <a href="/">Home</a> |
        <a href="/about/">About</a> | 
        <a href="/projects/">Projects</a> |
        <a href="/feeds/main.xml">RSS</a>
    </p>
    
    <h1 id="header">Installing additional files with distutils in Python 2.3</h1>
    <p id="date">
        Published 31st December 2008
    </p>
    <p>Installing additional files with distutils in Python 2.3 isn't as easy as
one expects it to be because the "data_files" attribute installs directly into
"sys.prefix" and not the package specific directory in "site-packages",
where one would expect such data.</p>
<p>Python 2.4 introduced the "package_data" attribute in distutils
which should be used instead, as it installs the data in the correct directory.
However, since there are still many packages around
which support Python 2.3, I thought I would write down this little advice.</p>
<p>To include additional files with distutils in Python 2.3,
the "<a href="http://www.python.org/doc/2.3.5/dist/setup-script.html#SECTION000350000000000000000">data_files</a>" argument must be used in the setup script:</p>
<div class="highlight"><pre>from distutils.core import setup

setup(name='foobar',
      version='1.0',
      data_files=[('docs', ['README']),],
)</pre></div>


<p>The sequence consists of pairs that specify the target directory
and files that should be installed there. So in the above example,
the "README" file would be installed into the "docs" directory.</p>
<p>Executing the above script in a virtual environment called "testenv"
will result in the following:</p>
<div class="highlight"><pre>copying README-&gt; /Users/arthurk/.virtualenvs/testenv/docs</pre></div>


<p>If other setup scripts would install a "README" file the same way,
the file would be overwritten with each successive installation.</p>
<p>The problem, of course, isn't new. Lonnie Princehouse has <a href="http://groups.google.com/group/comp.lang.python/browse_thread/thread/35ec7b2fed36eaec/2105ee4d9e8042cb">posted
a simple solution</a> to this problem over four years ago.</p>
<p>Distutils has a variable called "INSTALL_SCHEMES" where the paths
of the target directories for each platform are specified.</p>
<div class="highlight"><pre>INSTALL_SCHEMES: ['mac', 'unix_prefix', 'os2', 'nt', 'unix_home']
INSTALL_SCHEMES['mac']: {'purelib': '$base/Lib/site-packages',
                         'headers': '$base/Include/$dist_name',
                         'scripts': '$base/Scripts',
                         'data': '$base',
                         'platlib': '$base/Lib/site-packages'}</pre></div>


<p>The proposed solution sets the installation path of data files to to the path
of packages e.g. the "site-packages" directory.</p>
<p>That and the addition of a package specific identifier (can be the same value
as the "name" attribute, otherwise a "docs" directory would be created in 
"site-packages") result in the following setup script.</p>
<div class="highlight"><pre>from distutils.core import setup
from distutils.command.install import INSTALL_SCHEMES

for scheme in INSTALL_SCHEMES.values():
    scheme['data'] = scheme['purelib']

setup(name='foobar',
      version='1.0',
      data_files=[('foobar/docs', ['README']),],
)</pre></div>


<p>Executing the above script will copy the data into the proper directory.</p>
<div class="highlight"><pre>copying README-&gt; /Users/arthurk/.virtualenvs/testenv/lib/python2.5/site-packages/foobar/docs</pre></div>
    <h2>Comments</h2>
    <div id="disqus_thread"></div><script type="text/javascript" src="http://disqus.com/forums/arthurkozielsblog/embed.js"></script><noscript><p><a href="http://disqus.com/forums/arthurkozielsblog/?url=ref">View the discussion thread.</a></p></noscript><p><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a></p>

</body>
</html>